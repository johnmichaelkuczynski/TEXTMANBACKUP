CURRENT STATE
There is NO database. The old database was destroyed. It does not exist. The DATABASE_URL in Secrets points to a new, empty Neon database with ZERO tables.
DO NOT attempt to connect to any database.
DO NOT create any tables.
DO NOT run any migrations.
DO NOT run db:push or any database commands.
DO NOT assume what tables exist — the database is empty.
I will create the tables myself in Neon after you tell me what tables are needed.

PART 1: DATABASE AND LENGTH REQUIREMENTS
I need to build a database that will make it possible for the app to process and generate documents of ANY length — from 1 word to 500,000 words.
Length Requirements (NON-NEGOTIABLE)
If the user asks for 90,000 words, they get AT LEAST 90,000 words. Not 78,000. Not 89,000. Not 89,999. The output length must ALWAYS EQUAL OR EXCEED what the user requests. This applies to ALL lengths. No exceptions. If the system cannot hit the target, it must keep generating until it does — or fail explicitly and tell the user why it failed.
Coherence Requirements (NON-NEGOTIABLE)
All documents must be 100% coherent regardless of length. Coherence at scale requires database persistence — not in-memory processing. The database must enforce the coherence pipeline by storing state between chunks.
Storage Requirements (NON-NEGOTIABLE)
The database must store absolutely everything generated by the user. Permanently. Until I manually delete it. This includes every input, every output, every intermediate state, every error. Nothing is temporary. Nothing is in-memory only. Everything persists.

PART 2: MANDATORY AUDIT SYSTEM
The app is not allowed to silently "process" and then deposit a finished output. Every operation must produce TWO outputs:
OUTPUT 1: The user's requested output (the document, rewrite, analysis, etc.)
OUTPUT 2: A permanent, streaming audit log documenting every single action the system took
Audit Log: Real-Time Streaming
Whenever the user triggers ANY operation:

Immediately open a live Audit Panel (popup/side-panel)
Stream every action in real time, line by line, as it happens
Nothing happens invisibly — if it's not in the log, it didn't happen

The stream must show:

Every database query (actual SQL text)
Every table accessed (which table, read or write)
Every row inserted (table name, row ID, key fields)
Every row updated (table name, row ID, what changed)
Every LLM call: model name, token count (input/output), prompt summary, response summary, latency (ms)
Every chunk processed: chunk index, input word count, output word count, target word count, pass/fail
Every error (full error text)
Timestamps for every action

Audit Log: User Access
The user must be able to:

Watch it live as it streams
Scroll back through the log during generation
Copy any portion
Download the full log (JSON or TXT)
Access it after completion — stays visible until dismissed
Retrieve it later from their account (Job History page)

Audit Log: Permanent Storage
Every audit log must be:

Stored in the database immediately as events occur
Linked to the user's account
Linked to the output it produced
Accessible from a Job History / Audit Logs section
Never auto-deleted


PART 3: WHAT I NEED FROM YOU
Step 1: Read the codebase.
Step 2: Tell me exactly what tables the app needs — every table name and every column. Do not invent anything. Only report what the code actually expects.
Step 3: Tell me if the current schema (as defined in the code) supports the requirements above. If anything is missing to meet the length, coherence, storage, and audit requirements, tell me what needs to be added.
Step 4: Wait for me to create the tables. You will not touch the database.

THE RULE
If it's not in the audit log, it didn't happen.
If it's not in the database, it wasn't saved.
If the output is short, the system failed.
The audit log is not a debugging feature. It is proof that the system did what it claims. The database is not optional. It is the mechanism that makes coherence possible. The length target is not a suggestion. It is a hard requirement.

Confirm you understand. Then do Step 1, Step 2, and Step 3. Do not do anything else.